---
title: "let и const в ES2015"
layout: post
categories: javascript
tags: [let, const, javascript, ES2015, ES6]
share: true
---

*Прочтение* и *переосмысление* замечательного руководства [Переменные: let и const](https://learn.javascript.ru/let-const) по новшествам в ES6. Не более и не менее. Статья ни на что большее не претендует, разве слегка помощь хозяину в освоении новшевств ES2015.

В ES6 **взамен** служебного слова `var`, служащего для объявления переменной, введены два служебных слова - `let` и `const`. Другими словами, это новый способ объявления переменных.

**Например:**

{% highlight javascript %}
let count = 10;
const number = 20;
{% endhighlight %}

### let

#### Область видимости let

Переменная, объявленная через `var`, является видимой внутри всего js-файла:

{% highlight javascript %}
var number = 5;
function () {
	var number = 10;
	alert(number);
}
alert(number);
{% endhighlight %}

Код выше читается таким образом. Объявляется переменная `number` и присваивается ей значение `5`. Внутри функции переменная `number` **не создается заново**; берется "старая" переменная `number` и переопределяется значением `10`.

Оба последующих `alert` выведут одно и тоже значение `10`, ибо "старая добрая" `number` как была в самом начале, так и осталась - просто ей придали другое значение.

Переменная, объявленная через `let`, имеет область видимости только **внутри блока**, внутри которого она была объявлена:

{% highlight javascript %}
let number = 5;
function () {
	let number = 10;
	alert(number); // вернет значение 10
};
alert(number) // вернет значение 5
{% endhighlight %}

Здесь, фактически, две **независимые переменные** `number`, одна — **глобальная**, вторая — **локальная** (*внутри функции*).

Заметим, что если объявление `let number` в первой строке удалить, то в последнем `alert` будет ошибка: **переменная неопределена**:

{% highlight javascript %}
function () {
	let number = 10;
	alert(number);
};
alert(number); // ошибка, так как переменная number не объявлена
{% endhighlight %}

Это потому что переменная `let` всегда видна именно в **том блоке, где объявлена, и не более**.

#### Переменная `let` видна только после объявления

Как мы помним, переменные `var` существуют и **до объявления**. Они равны `undefined`:

{% highlight javascript %}
alert(number) // number is undefined
var number = 10;
{% endhighlight %}

С переменными `let` все проще. **До объявления их вообще нет**. Такой доступ приведет к ошибке:

{% highlight javascript %}
alert(number); // error - переменной number не существует
let number = 10;
{% endhighlight %}

Заметим также, что переменные `let` **нельзя повторно объявлять**. То есть, такой код выведет ошибку:

{% highlight javascript %}
let number;
let number = 10; // ошибка - переменная `number` уже объявлена
{% endhighlight %}

Это — хоть и выглядит ограничением по сравнению с `var`, но на самом деле проблем не создает. Например, два таких цикла совсем **не конфликтуют**:

{% highlight javascript %}
// каждый цикл имеет свою переменную `i`
for (let i=0; i<10; i++) {}
for (let i=0; i<10; i++) {}
alert( i ); // ошибка - глобальной `i` нет
{% endhighlight %}

При объявлении **внутри цикла** переменная `i` будет **видна только в блоке цикла**. Она **не видна снаружи**, поэтому будет ошибка в последнем `alert`.

#### При использовании в цикле, для каждой итерации создается своя переменная

{% highlight javascript %}
function makeArmy() {

  let shooters = [];

  for (let i = 0; i < 10; i++) {
    shooters.push(function() {
      alert( i ); // выводит свой номер
    });
  }

  return shooters;
}

var army = makeArmy();

army[0](); // 0
army[5](); // 5
{% endhighlight %}

Каждому повторению цикла соответствует своя независимая переменная `let`. Если внутри цикла есть вложенные объявления функций, то в замыкании каждой будет та переменная, которая была при соответствующей итерации.

### const

Объявление `const` задает **константу**, то есть **переменную, которую нельзя менять**:

{% highlight javascript %}
const count = 5;
count = 15; // ошибка при изменении значения константы
{% endhighlight %}

В остальном объявление `const` полностью аналогично `let`.

***
