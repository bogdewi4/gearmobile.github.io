---
layout: post
title: "Notepad++ - запись и использование макросов"
author: gearmobile
tags: [notepad++, macros]
---

Одной из полезных возможностей программы Notepad++ является создание и использование макросов. Пользователям, которые знакомы с популярным офисным пакетом MS Office (и Microsoft Excel в частности) должно быть знакомо понятие макросов. Если не знакомо, то вкратце поясню.

Макрос - это последовательность действий пользователя в программе, записанная и сохраненная этой программой. То есть, если в своей повседневной работе вы выполняете постоянно какие либо действия, то их можно записать с тем, чтобы не повторять снова. В последствии такую последовательность действий можно запустить на выполнение одним щелчком мыши или сочетанием горячих клавиш.

Сам процесс записи очень похож на то, как если бы действия в программе записывались на видеокамеру. Только в качестве пленки в этом случае выступает программный код. Точнее, язык программирования, в который переводится все манипуляции, которые пользователь выполняет в программе. Язык программирования может быть разным и целиком зависеть от конкретной программы. Например, в Microsoft Excel таким языком является VBA (Visual Basic for Applications). Для обычного пользователя знать как язык программирования, на котором кодируется действия, совсем необязательно. Ему достаточно уметь записывать макросы и запускать их на выполнение.

Вернемся к программному блокноту Notepad++. Чем могут быть полезны макросы в этом случае. Да тем же самым. Допустим, при написании кода существуют какие-либо его участки (куски), которые повторяются постоянно. Кстати, такие повторяющиеся куски кода называются сниппетами.

Так вот, такие сниппеты приходится вводить вручную снова и снова. Чтобы ускорить работу и облегчить ее, можно записать такие программные куски в качестве последовательности действий. А затем вставлять в текст одним нажатием горячих клавиш.

Давайте на примере разберем, каким образом можно записать и использовать макросы в Notepad++. Первое, что необходимо узнать, это какие кнопки отвечают за работу макросов. Посмотрите на панель инструментов Notepad++. Ближе к концу этой панели располагаются в ряд пять кнопок, каждая из которых отвечает за определенное действие:

<figure id="attachment_685" style="width: 600px;" class="wp-caption aligncenter">
  [<img src="http://localhost:7788/third/wp-content/uploads/2013/04/buttons_set_for_macros_notepad-600x303.png" alt="Набор кнопок для работы с макросами в Notepad++" width="600" height="303" class="size-medium wp-image-685" />][1]
  <figcaption class="wp-caption-text">Набор кнопок для работы с макросами в Notepad++</figcaption>
</figure>

Назначение каждой из них по порядку:

  1. Старт записи макроса
  2. Остановка записи макроса
  3. Воспроизведение записанного макроса
  4. Многократное воспроизведение записанного макроса
  5. Сохранение записанного макроса

Набор совсем несложный и разобраться в нем легко. Теперь давайте приступим к записи какого-либо макроса, чтобы увидеть воочию, как это делается. Предположим, что в качестве часто повторяемого кода (сниппета) у нас будет выступать строка `document.write();`, которую довольно часто применяют в коде javascript-программисты.

Нажимаем кнопку "Старт записи макроса". При этом кнопка из красной превратиться в серую, что означает - запись пошла. Без ошибок, аккуратно вводим в основном окне Notepad++ вышеуказанную строку:

<figure id="attachment_686" style="width: 600px;" class="wp-caption aligncenter">
  [<img src="http://localhost:7788/third/wp-content/uploads/2013/04/start_record_macros_notepad-600x268.png" alt="Запись макроса в Notepad++" width="600" height="268" class="size-medium wp-image-686" />][2]
  <figcaption class="wp-caption-text">Запись макроса в Notepad++</figcaption>
</figure>

Когда строка введена, нажимаем кнопку "Остановка записи макроса". Программа Notepad++ записала наши действия. В данном случае - это строка кода, которую мы ввели. Чтобы проверить, что запись была произведена верно, нажмем кнопку "Воспроизведение записанного макроса". Notepad++ в точности воспроизведет указанную строку, если все было выполнено нами верно. Если нужно воспроизвести записанный макрос несколько раз, можно нажать кнопку "Многократное воспроизведение записанного макроса".

Теперь необходимо сохранить записанный нами макрос, так как он хранится в оперативной памяти программы Notepad++ только до момента ее закрытия. Как только мы ее закроем, макрос пропадет. Для сохранения нажимаем кнопку "Сохранение записанного макроса". Появится окно, в котором предлагается задать сочетание "горячих клавиш" для сохраняемого макроса и его имя для сохранения. выбираем любое понравившееся сочетание, а также задаем имя для макроса:

<figure id="attachment_687" style="width: 291px;" class="wp-caption aligncenter">
  [<img src="http://localhost:7788/third/wp-content/uploads/2013/04/saving_macros_in_notepad.png" alt="Сохранение макроса в Notepad++" width="291" height="205" class="size-full wp-image-687" />][3]
  <figcaption class="wp-caption-text">Сохранение макроса в Notepad++</figcaption>
</figure>

Проверить, произошло ли сохранение макроса, можно двумя способами. Первый - это перейти в меню "Макросы". В выпадающей списке, наряду с общесистемными командами Notepad++ должен находиться и наш макрос `document.write();`. Второй способ - это открыть список всех сохраненных в программе макросов. Делается это через меню "Макросы - Изменить гор.клавишу/Удалить макрос". Откроется окно редактирования, в котором должен быть представлен наш макрос:

<figure id="attachment_688" style="width: 600px;" class="wp-caption aligncenter">
  [<img src="http://localhost:7788/third/wp-content/uploads/2013/04/saved_macros_notepad-600x329.png" alt="Список сохраненных макросов Notepad++" width="600" height="329" class="size-medium wp-image-688" />][4]
  <figcaption class="wp-caption-text">Список сохраненных макросов Notepad++</figcaption>
</figure>

В этом окне можно удалить сохраненный макрос кнопкой "Delete". Или же изменить сочетание горячих клавиш для этого макроса кнопкой "Modify".

Как вы уже догадались, с помощью макроса можно сохранять абсолютно любой код. Это может не обязательно javascript-сниппет, но и часть html или css кода, если вы занимаетесь версткой в программе Notepad++.

На этом обзор макросов в Notepad++ закончен.

 [1]: http://localhost:7788/third/wp-content/uploads/2013/04/buttons_set_for_macros_notepad.png
 [2]: http://localhost:7788/third/wp-content/uploads/2013/04/start_record_macros_notepad.png
 [3]: http://localhost:7788/third/wp-content/uploads/2013/04/saving_macros_in_notepad.png
 [4]: http://localhost:7788/third/wp-content/uploads/2013/04/saved_macros_notepad.png
